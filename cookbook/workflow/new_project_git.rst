Как создать и разместить Проект на Symfony2 в git-репозитории
=================================================

.. tip::

    Несмотря на то, что эта статья посвещяна git, основные принципы,
    описанные тут, актуальны и для Subversion.

Если Вы уже прочитали статью :doc:`/book/page_creation` и немного познакомились
с Symfony, смело можно создавать свой собственный проект. Этот рецепт познакомит Вас
с лучшим способом создания проекта на Symfony2 с использованием системы контроля версий `git`_.

Предварительная настройка проекта
---------------------

Для начала Вам нужно скачать Symfony и инициализировать Ваш локальный
git репозиторий:

1. Скачайте `Symfony2 Standard Edition`_ без сторонных библиотек (without vendors).

2. Распакуйте дестрибутив. Будет создана директория Symfony с базовой
   структурой проекта, файлами конфигурации и т.д. Переименуйте ее, как
   сочтете нужным.

3. Создайте новый файл с именем ``.gitignore`` в корне Вашего проекта
   и вставьте в него следующий код. Все файлы, совпадающие с перечисленными
   шаблонами, git будет игнорировать:

    .. code-block:: text

        /web/bundles/
        /app/bootstrap*
        /app/cache/*
        /app/logs/*
        /vendor/
        /app/config/parameters.yml

4. Скопируйте ``app/config/parameters.yml`` в ``app/config/parameters.yml.dist``.
   Файл ``parameters.yml`` игнорируется git'ом (смотрите выше), поэтому такие
   машино-зависимые настройки, как например пароль от базы данных, не будут отправляться в репозиторий.
   Имея файл ``app/config/parameters.yml.dist`` в репозитории, новые разработчики смогут
   быстро выгрузуть проект, скопировать этот файл в ``parameters.yml``, настроить его и
   начать разработку.

5. Инициализируйте Ваш git репозиторий:

    .. code-block:: bash

        $ git init

6. Добавьте все начальные файлы в git:

    .. code-block:: bash

        $ git add .

7. Создайте первый коммит Вашего проекта:

    .. code-block:: bash

        $ git commit -m "Initial commit"

8. Наконец, скачайте все сторонние библиотеки:

    .. code-block:: bash

        $ php bin/vendors install

На этом моменте Вы имеете полностью функционирующий проект на Symfony2, который
правильно размещен в git. Вы можете начинать программировать и отправлять изменения
в Ваш репозиторий.

Сейчас Вы можете переключиться на статью :doc:`/book/page_creation`
для изучения вопросов конфигурации и разработки Вашего приложения.

.. tip::

    Стандартная версия Symfony2 содержит в себе некоторый функционал для демонстрации.
    Чтобы убрать демонстрационный код, следуйте инструкциям `Standard Edition Readme`_.

.. _cookbook-managing-vendor-libraries:

Управление внешними библиотеками с помощью bin/vendors и deps
---------------------------------------------------

Каждый проект на Symfony использует большую группу сторонних библиотек.

По умолчанию, эти библиотеки скачиваются при запуске команды ``php bin/vendors install``.
Этот скрипт читает из файла ``deps`` и скачивает полученные библиотеки в папку
``vendor/``. Он также читает файл ``deps.lock`` и связывает каждую упомянутую библиотеку
с указанным git хешем в репозитории.

В нашем проекте сторонние библиотеки не являются частью git репозитория.
Они также не являются дочерними модулями (submodules). Вместо этого мы
полагаемся на файлы ``deps`` и ``deps.lock``, а также на скрипт ``bin/vendors``,
который всем управляет. Эти файлы лежат в репозитории, и каждая версия проекта
использует необходимые версии сторонних библиотек. Получается, Вы можете
использовать скрипт vendors, чтобы Ваш проект был в актуальном состоянии.

Всякий раз, когда разработчик копирует проект, он должен выполнить скрипт
``php bin/vendors install`` чтобы убедиться, что все необходимые сторонние библиотеки
установлены.

.. sidebar:: Обновление Symfony

    Поскольку Symfony это группа сторонних библиотек и эти сторонние
    библиотеки полностью контролируются через ``deps`` и ``deps.lock``,
    обновление Symfony - это простое обновление этих файлов до состояния их
    в последней версии Symfony Standard Edition.

    Конечно же, если Вы добавили дополнительные источники в ``deps`` или ``deps.lock``,
    убедитесь, что обновляете только оригинальные источники (т.е. не трогайте
    Ваши дополнительные источники).

.. caution::

    Также существует команда ``php bin/vendors update``, но она не предназначена
    для обновления Вашего проекта и Вам не надо ее использовать в работе. Эта
    команда служит для фиксации версий всех Ваших сторонних библиотек при обновлений
    их до версии, указанной в ``deps``, и записывает их хеши в файл ``deps.lock``.

    Кроме того, если Вам захотелось обновить файл ``deps.lock`` в соответствии с
    установленными сторонними библиотеками, то просто запустите команду ``php bin/vendors lock``
    чтобы сохранить соответствующие git SHA идентификаторы в файле deps.lock.

Сторонние библиотеки и Дочерние модули
~~~~~~~~~~~~~~~~~~~~~~

Вместо того, чтобы использовать ``deps`` и скрипт ``bin/vendors`` для управления
Вашими сторонними библиотеками, Вы можете использовать родные `git submodules`_.
Нет ничего плохого в этом выборе, но система ``deps`` - это официальное решение
этой проблемы и дочерние модули git'а могут внести дополнительные сложности в работу.

Хранение Вашего проекта на Удаленном Сервере
---------------------------------------

Сейчас у Вас имеется полностью функционирующий проект на Symfony2,
сохраненный в git. Тем не менее, во многих случаях Вам понадобится
хранить проект на удаленном сервере. Например для хранения резервной
копии проекта или чтобы другие разработчики также имели доступ к проекту
для совместной работы.

Самый простой способ хранить Ваш проект на удаленном сервере - это `GitHub`_.
На нем публичный репозитории бесплатны. За закрытые репозитории
Вам нужно будет платить ежемесячную плату.

С другой стороны, Вы можете хранить Ваш git репозиторий на любом сервере.
Достаточно лишь создать `barebones repository`_ и загрузить данные на него.
Библиотека `Gitolite`_ может помочь Вам в этом процессе.

.. _`git`: http://git-scm.com/
.. _`Symfony2 Standard Edition`: http://symfony.com/download
.. _`Standard Edition Readme`: https://github.com/symfony/symfony-standard/blob/master/README.md
.. _`git submodules`: http://book.git-scm.com/5_submodules.html
.. _`GitHub`: https://github.com/
.. _`barebones repository`: http://progit.org/book/ch4-4.html
.. _`Gitolite`: https://github.com/sitaramc/gitolite

.. toctree::
    :hidden:

    Translation source: 2012-01-08 [de00067aa5]
